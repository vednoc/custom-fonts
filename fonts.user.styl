/* ==UserStyle==
@name         Custom fonts
@namespace    github.com/vednoc/custom-fonts
@description  Apply custom base font globally.
@author       vednoc <vednoc@pm.me> (https://github.com/vednoc)
@homepageURL  https://github.com/vednoc/custom-fonts
@supportURL   https://github.com/vednoc/custom-fonts/issues
@updateURL    https://userstyles.world/api/style/85.user.css
@preprocessor stylus
@version      0.1.0
@license      MIT

@var text base 'Base font' '"your favorite base font"'
@var text mono 'Mono font' '"your favorite mono font"'
@var checkbox inputs 'Use monospace font in input areas' 0
==/UserStyle== */

@-moz-document regexp("https?://.*") {
    i = !important

    // Exclude default code areas.
    n ?= ':not(code):not(pre):not(pre > span):not(code > span)'

    // Exclude icon fonts.
    n += ':not([class^="fa"]):not(.i):not(.icon)'
    n += ':not([class*="octicon-"])' // github
    n += ':not(.glyphicon)' // searx
    n += ':not([aria-hidden=true])' // google meet

    // Exclude code areas on GitHub.
    n += ':not([class^="blob-"]):not([class^="blob-"] > span)'

    // Exclude code areas on GitLab.
    n += ':not(.diff-line-num):not(pre > code > span span)'
    n += ':not(.diff-viewer *)' // commit diff

    // Editors.
    n += ':not(.ace_editor):not(.ace_editor *)' // #2
    n += ':not(.CodeMirror):not(.CodeMirror *)'
    n += ':not(.monaco-editor *)'
    n += ':not(#squire *)' // protonmail

    // Exclude Gmail composer and font menu.
    n += ':not(div[jsaction][jslog] *)'
    n += ':not([id][style*="font-family"]):not([id][style*="font-family"] *)'

    // Exclude utility classes for fonts.
    n += ':not(.monospace):not(.text-mono)'

    // Feat -> Change base fonts in input areas.
    if inputs {
        n += ':not(input):not(textarea)'

        // Gmail elements.
        $d += ':not([g_editable]):not()'
        $i += ':not([name="subjectbox"])'

        // Workaround for specificity issues.
        :not(#z) {
            [contenteditable="true"]{ $d } *, // discord
            input{ $i },
            textarea {
                font-family: mono, monospace i
            }
        }
    }

    // Generate.
    { n } {
        font-family: base, serif i
    }
}
